
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Machine Learning Docs">
      
      
      
        <link rel="canonical" href="https://nickuzmenkov.github.io/ml_docs/basics/classification/">
      
      
        <link rel="prev" href="../regression/">
      
      
        <link rel="next" href="../ensemble/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.1.21">
    
    
      
        <title>Classification - ML Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.eebd395e.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#classification" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="ML Docs" class="md-header__button md-logo" aria-label="ML Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ML Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Classification
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/nickuzmenkov/ml_docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ml_docs
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ML Docs" class="md-nav__button md-logo" aria-label="ML Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    ML Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/nickuzmenkov/ml_docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ml_docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Basics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Basics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data/" class="md-nav__link">
        Data and Sampling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../eda/" class="md-nav__link">
        Exploratory Data Analysis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../statistical_tests/" class="md-nav__link">
        Statistical Tests
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../regression/" class="md-nav__link">
        Regression
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Classification
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Classification
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#binary-classification" class="md-nav__link">
    Binary classification
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ensemble/" class="md-nav__link">
        Ensemble
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Linear Models
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Linear Models
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linear_models/linear_regression/" class="md-nav__link">
        Linear Regression
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linear_models/linear_classification/" class="md-nav__link">
        Linear Classification
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linear_models/regularization/" class="md-nav__link">
        Regularization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linear_models/lda/" class="md-nav__link">
        Linear Discriminant Analysis
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Trees
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Trees
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../trees/decision_trees/" class="md-nav__link">
        Decision Trees
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../trees/random_forest/" class="md-nav__link">
        Random Forest
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../trees/gradient_boosted_trees/" class="md-nav__link">
        Gradient Boosted Trees
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Other Models
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Other Models
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../other_models/naive_bayes/" class="md-nav__link">
        Naive Bayes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../other_models/svm/" class="md-nav__link">
        Support Vector Machines
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../other_models/pca/" class="md-nav__link">
        Principal Component Analysis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../other_models/knn/" class="md-nav__link">
        K-Nearest Neighbors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../other_models/hierarchical_clustering/" class="md-nav__link">
        Hierarchical Clustering
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../other_models/k_means/" class="md-nav__link">
        K-Means Clustering
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#binary-classification" class="md-nav__link">
    Binary classification
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="classification">Classification</h1>
<h3 id="binary-classification">Binary classification</h3>
<h1 id="empty">empty</h1>
<h3 id="multiclass-classification">Multiclass classification</h3>
<p>[[Naive Bayes|Naive Bayes]], [[Linear Models#Gradient Descent|SGD]], and [[Random Forest|Random Forest]] classifiers have native support for multiclass classification tasks.</p>
<p>On the contrary, [[Linear Models#Logistic Regression|Logistic Regression]] and [[Support Vector Machines#Classification|SVC]] do not support it. However, these models can  be scaled to handle multiclass classification tasks as well using either <em>one-versus-the-rest</em> (<em>OvR</em>) or <em>one-versus-one</em> (<em>OvO</em>) approach.</p>
<blockquote>
<p>ðŸ’¡This is exactly what sklearn implicitly does for such models.</p>
</blockquote>
<h4 id="one-versus-the-rest-ovr">One-Versus-the-Rest (OvR)</h4>
<p>Train class detectors for each class (e.g. class A, not class A). For inference choose the highest probability among all models. Requires $N$ models to be fitted with the eintire dataset.</p>
<h1 id="code-sklearnmulticlassonevsrestclassifier">code  <code>sklearn.multiclass.OneVsRestClassifier</code>.</h1>
<h4 id="one-versus-one-ovo">One-Versus-One (OvO)</h4>
<p>Train models to distinguish between each pair of classes. For inference choose the class winning maximum number of duels. Requires $N(N-1)/2$ models to be fitted with $2/N$ fraction of the dataset.</p>
<h1 id="code-sklearnmulticlassonevsoneclassifier">code   <code>sklearn.multiclass.OneVsOneClassifier</code>.</h1>
<h3 id="multilabel-classification">Multilabel classification</h3>
<h1 id="empty_1">empty</h1>
<h3 id="multioutput-classification">Multioutput classification</h3>
<p><em>Multioutput classification</em> is generalization of multilabel classification to more than one class for each label.</p>
<h2 id="strategies-for-imbalanced-data">Strategies for Imbalanced Data</h2>
<p>When one of the classes in the dataset is rare (e.g. fraud, churn, cancer, etc.) thereâ€™s a decent probability of observing similar records in the majority class just by chance. This is likely to disrupt the whole training process.</p>
<p>In this case one should also concern about the correct choice of metrics, since monitoring wrong metrics (e.g. accuracy) can yield satisfying results even if the model only predicts the majority class all the time.</p>
<blockquote>
<p>ðŸ’¡ Stratified KFold is handy for multiclass classification problems (especially for those with imbalanced data) hence it makes sure each class is represented like in the original distribution.</p>
</blockquote>
<h3 id="undersampling">Undersampling</h3>
<p><em>Undersampling</em> the majority class is usually applied when thereâ€™s a lot of data available.</p>
<h3 id="oversampling">Oversampling</h3>
<p><em>Oversampling</em> the minority class is applied when the opposite is true. Underrepresented classâ€™ records can be bootstrapped forming a larger sample.</p>
<h3 id="weighted-samples">Weighted Samples</h3>
<p><em>Applying weights</em> is an option in both cases. Weights are selected so that the sum of weights of both classes are equal (e.g. if $p$ is the fraction of the minority class, then either the minority records can be weighted as $1/p$ or the majority records can be weighted as $p$).</p>
<h2 id="examples">Examples</h2>
<h3 id="multiclass-classification-example">Multiclass Classification #example</h3>
<p>![[assets/img/Statistics/Classification/01.png|700]]</p>
<h1 id="sourcecode-classification-codeiris-multiclass-classification">sourcecode [[Classification Code#Iris Multiclass Classification]].</h1>
<h3 id="multiloutput-classification-example">Multiloutput Classification #example</h3>
<p>![[assets/img/Statistics/Classification/02.png|700]]</p>
<h1 id="sourcecode-classification-codemnist-denoising">sourcecode [[Classification Code#MNIST Denoising]]</h1>
<h3 id="accuracy">Accuracy</h3>
<p>Accuracy is simply a fraction of all correct predictions</p>
<p>$$
\text{Accuracy}=\frac{\text{TP}+\text{TN}}{n}
$$</p>
<p>where $\text{TP}$ is the total number of true positives and $\text{TN}$ is the total number of true negatives.</p>
<h1 id="code-sklearnmetricsaccuracy_scorey_true-y_pred">code <code>sklearn.metrics.accuracy_score(y_true, y_pred)</code>.</h1>
<h3 id="confusion-matrix">Confusion Matrix</h3>
<p>Confusion matrix is a way to present results in a form of table with rows of true values and columns of predicted values, giving all possible true/false rates. For #example:</p>
<table>
<thead>
<tr>
<th>True\Predicted</th>
<th>A</th>
<th>B</th>
</tr>
</thead>
<tbody>
<tr>
<td>A</td>
<td>13</td>
<td>2</td>
</tr>
<tr>
<td>B</td>
<td>3</td>
<td>12</td>
</tr>
</tbody>
</table>
<blockquote>
<p>ðŸ’¡ #warning Confusion matrix is not necessarily symmetrical and thus cannot be cut along diagonal like the correlation matrix.</p>
</blockquote>
<h1 id="code-sklearnmetricsconfusion_matrixy_true-y_pred">code <code>sklearn.metrics.confusion_matrix(y_true, y_pred)</code>.</h1>
<h3 id="precision">Precision</h3>
<p>Precision is the accuracy of the positive predictions (i.e. the ratio of correctly predicted positives to all predicted positives):</p>
<p>$$
\text{Precision}=\frac{\text{TP}}{\text{TP}+\text{FP}}
$$</p>
<p>A trivial perfect-precision-model is that one predicting a single positive making sure itâ€™s correct (i.e. the one of the highest confidence score).</p>
<p>Can be drawn from confusion matrix: true positives in the column divided by the sum of the column. For #example from the [[#Confusion Matrix|above Confusion Matrix]] </p>
<p>$$
\text{Precision}=12/(12+2)=0.86
$$</p>
<p>(i.e. when model predicts class B it is correct 86% of the time).</p>
<h1 id="code-sklearnmetricsprecision_scorey_true-y_pred">code <code>sklearn.metrics.precision_score(y_true, y_pred)</code>.</h1>
<h3 id="recall">Recall</h3>
<p>Recall (or <em>true positive rate</em>) is the ratio of correctly predicted positives to actual positives:</p>
<p>$$
\text{Recall}=\frac{\text{TP}}{\text{TP}+\text{FN}}
$$</p>
<p>A trivial perfect-recall-model is that one always predicting positives.</p>
<p>Can be drawn from confusion matrix: true positives in the row divided by the sum of the row. E.g. from the [[#Confusion Matrix|above Confusion Matrix]]</p>
<p>$$
\text{Recall}=12/(12+3)=0.80
$$</p>
<p>(i.e. model detected 80% of class B instances).</p>
<h1 id="code-sklearnmetricsrecall_scorey_true-y_pred">code <code>sklearn.metrics.recall_score(y_true, y_pred)</code>.</h1>
<h3 id="specificity">Specificity</h3>
<p>Similarly to recall, specificity (or <em>true negative rate</em>) is the ratio of correctly predicted negatives to actual negatives:</p>
<p>$$
\text{Specificity}=\frac{\text{TN}}{\text{TN}+\text{FP}}
$$</p>
<p>Thereâ€™s no direct <code>sklearn</code> implementation for specificity. But the required values can be drawn from the [[#Confusion Matrix]]. </p>
<h3 id="f1-score">F1-Score</h3>
<p>F1-score is a way to measure precision-recall trade-off as a <em>harmonic mean</em> between them:</p>
<p>$$
F_1=\frac{2}{\text{Precision}^{-1} + \text{Recall}^{-1}} = \frac{\text{TP}}{\text{TP} + 0.5(\text{FP} + \text{FN})}
$$</p>
<p>F1-score is computed as the harmonic mean (and not the regular mean) because it gives much more weight to low values. It thus can be high only if both precision and recall are high.</p>
<p>F1-score, however, does not take into account true negative rate.</p>
<blockquote>
<p>ðŸ’¡ A more generic $F_\beta$ score applies additional weights, valuing one of precision or recall more than the other.</p>
</blockquote>
<h1 id="code-sklearnmetricsf1_scorey_true-y_pred">code <code>sklearn.metrics.f1_score(y_true, y_pred)</code>.</h1>
<h2 id="precisionrecall-trade-off">Precision/Recall Trade-Off</h2>
<p>Precision and recall are mirroring metrics. Think about this:</p>
<p>![[assets/img/Statistics/Classification Metrics/01.png|600]]</p>
<ul>
<li>As we increase the threshold there are fewer positives of higher confidence (those are less likely to be false positives), hence higher precision.</li>
<li>As we decrease the threshold, more positives are predicted, raising the chance to predict all actual positives (and false positives), hence higher recall.</li>
</ul>
<p>In most cases, either high precision or high recall is required most:</p>
<ul>
<li>Adult content filter (positive is <em>safe</em>): high precision is required, low recall is acceptable.</li>
<li>Shoplifter identifier (positive is <em>suspect</em>): high recall is required, low precision is acceptable.</li>
</ul>
<p>There are 2 visual representations for precision/recall trade-off: precision-recall (PR) curve and receiver operating curve (ROC). Both can give insights and help to choose a proper threshold based on precision and recall relative importance.</p>
<blockquote>
<p>ðŸ’¡ It's generally advisable to choose PR curve when the positive class is rare or when you care more about false positives. Otherwise it is suggested to use ROC.</p>
</blockquote>
<h3 id="pr-precision-recall-curve">PR (Precision-Recall) Curve</h3>
<p>There are two ways to plot the PR curve. One is precision and recall versus the probability (<code>predict_proba</code>) or decision function (<code>decision_function</code>) threshold:</p>
<p>![[assets/img/Statistics/Classification Metrics/03.png|500]]
The other way is to plot precision versus recall directly:
![[assets/img/Statistics/Classification Metrics/02.png|700]]</p>
<h1 id="code-sklearnmetricsprecision_recall_curve">code <code>sklearn.metrics.precision_recall_curve</code>.</h1>
<h1 id="sourcecode-classification-metrics-codepr-curve">sourcecode [[Classification Metrics Code#PR Curve]].</h1>
<h3 id="roc-receiver-operating-characteristics-curve">ROC (Receiver Operating Characteristics) Curve</h3>
<p>ROC curve shows $1-\text{Specificity}$ (also <em>called false positive rate</em>) versus recall (t<em>rue positive rate</em>):</p>
<p>![[04.png|500]]</p>
<p>The analytic way to compute ROC is like this:</p>
<ol>
<li>Sort records descending by predicted probability.</li>
<li>Compute cumulative specificity and recall on sorted records.</li>
</ol>
<h1 id="code-sklearnmetricsroc_curve">code <code>sklearn.metrics.roc_curve</code>.</h1>
<h1 id="sourcecode-classification-metrics-coderoc-curve">sourcecode [[Classification Metrics Code#ROC Curve]].</h1>
<h3 id="roc-auc-area-underneath-the-curve">ROC AUC (Area Underneath the Curve)</h3>
<p>A quantitative metric associated with the ROC curve is the <em>area underneath the curve</em> (AUC or ROC AUC). AUC is equal to 1.0 for a perfect classifier and to 0.5 for a random classifier.</p>
<blockquote>
<p>ðŸ’¡ Thus ROC is drawn for all possible thresholds, ROC AUC is threshold independent.</p>
</blockquote>
<h1 id="code-sklearnmetricsroc_auc_score">code <code>sklearn.metrics.roc_auc_score</code>.</h1>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections", "content.code.copy", "content.code.annotate", "content.code.select", "content.tooltips"], "search": "../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.220ee61c.min.js"></script>
      
        
          <script src="../../js/katex.js"></script>
        
      
        
          <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
        
      
        
          <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
        
      
    
  </body>
</html>