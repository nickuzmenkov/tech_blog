
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Nick Kuzmenkov Tech Blog">
      
      
      
        <link rel="canonical" href="https://nickuzmenkov.github.io/tech_blog/machine_learning/basics/regression/">
      
      
        <link rel="prev" href="../statistical_tests/">
      
      
        <link rel="next" href="../classification/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.1.21">
    
    
      
        <title>Regression - Nick Kuzmenkov Tech Blog</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.eebd395e.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#regression" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Nick Kuzmenkov Tech Blog" class="md-header__button md-logo" aria-label="Nick Kuzmenkov Tech Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Nick Kuzmenkov Tech Blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Regression
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/nickuzmenkov/tech_blog" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    tech_blog
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../python/functions/" class="md-tabs__link">
        Python
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../data/" class="md-tabs__link md-tabs__link--active">
        Machine Learning
      </a>
    </li>
  

  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Nick Kuzmenkov Tech Blog" class="md-nav__button md-logo" aria-label="Nick Kuzmenkov Tech Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Nick Kuzmenkov Tech Blog
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/nickuzmenkov/tech_blog" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    tech_blog
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Python
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Python
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/functions/" class="md-nav__link">
        Functions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/classes/" class="md-nav__link">
        Classes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/exceptions/" class="md-nav__link">
        Exceptions
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Machine Learning
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Machine Learning
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
      
      
      
        <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
          Basics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          Basics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data/" class="md-nav__link">
        Data and Sampling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../eda/" class="md-nav__link">
        Exploratory Data Analysis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../statistical_tests/" class="md-nav__link">
        Statistical Tests
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Regression
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Regression
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#parameters-confidence-intervals" class="md-nav__link">
    Parameters Confidence Intervals
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stepwise-regression" class="md-nav__link">
    Stepwise Regression
  </a>
  
    <nav class="md-nav" aria-label="Stepwise Regression">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vanilla-predictor-selection" class="md-nav__link">
    Vanilla Predictor Selection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#all-subset-regression" class="md-nav__link">
    All Subset Regression
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#forward-selection" class="md-nav__link">
    Forward Selection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backward-selection" class="md-nav__link">
    Backward Selection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#penalized-regression" class="md-nav__link">
    Penalized Regression
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#categorical-variables-in-regression" class="md-nav__link">
    Categorical Variables in Regression
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interpreting-the-regression-equation" class="md-nav__link">
    Interpreting the Regression Equation
  </a>
  
    <nav class="md-nav" aria-label="Interpreting the Regression Equation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#correlated-predictors" class="md-nav__link">
    Correlated predictors
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multicollinearity" class="md-nav__link">
    Multicollinearity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#confounding-variables" class="md-nav__link">
    Confounding variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interactions" class="md-nav__link">
    Interactions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#regression-diagnostics" class="md-nav__link">
    Regression Diagnostics
  </a>
  
    <nav class="md-nav" aria-label="Regression Diagnostics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#outliers-in-residuals" class="md-nav__link">
    Outliers in Residuals
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#influential-values" class="md-nav__link">
    Influential values
  </a>
  
    <nav class="md-nav" aria-label="Influential values">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hat-values" class="md-nav__link">
    Hat Values
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cooks-distance" class="md-nav__link">
    Cook's Distance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bubble-plot" class="md-nav__link">
    Bubble Plot
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../classification/" class="md-nav__link">
        Classification
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ensemble/" class="md-nav__link">
        Ensemble
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
      
      
      
        <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
          Linear Models
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Linear Models
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linear_models/linear_regression/" class="md-nav__link">
        Linear Regression
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linear_models/linear_classification/" class="md-nav__link">
        Linear Classification
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linear_models/regularization/" class="md-nav__link">
        Regularization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linear_models/lda/" class="md-nav__link">
        Linear Discriminant Analysis
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
          Trees
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          Trees
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../trees/decision_trees/" class="md-nav__link">
        Decision Trees
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../trees/random_forest/" class="md-nav__link">
        Random Forest
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../trees/gradient_boosted_trees/" class="md-nav__link">
        Gradient Boosted Trees
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
      
      
      
        <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
          Other Models
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_4">
          <span class="md-nav__icon md-icon"></span>
          Other Models
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../other_models/naive_bayes/" class="md-nav__link">
        Naive Bayes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../other_models/svm/" class="md-nav__link">
        Support Vector Machines
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../other_models/pca/" class="md-nav__link">
        Principal Component Analysis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../other_models/knn/" class="md-nav__link">
        K-Nearest Neighbors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../other_models/hierarchical_clustering/" class="md-nav__link">
        Hierarchical Clustering
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../other_models/k_means/" class="md-nav__link">
        K-Means Clustering
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#parameters-confidence-intervals" class="md-nav__link">
    Parameters Confidence Intervals
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stepwise-regression" class="md-nav__link">
    Stepwise Regression
  </a>
  
    <nav class="md-nav" aria-label="Stepwise Regression">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vanilla-predictor-selection" class="md-nav__link">
    Vanilla Predictor Selection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#all-subset-regression" class="md-nav__link">
    All Subset Regression
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#forward-selection" class="md-nav__link">
    Forward Selection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backward-selection" class="md-nav__link">
    Backward Selection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#penalized-regression" class="md-nav__link">
    Penalized Regression
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#categorical-variables-in-regression" class="md-nav__link">
    Categorical Variables in Regression
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interpreting-the-regression-equation" class="md-nav__link">
    Interpreting the Regression Equation
  </a>
  
    <nav class="md-nav" aria-label="Interpreting the Regression Equation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#correlated-predictors" class="md-nav__link">
    Correlated predictors
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multicollinearity" class="md-nav__link">
    Multicollinearity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#confounding-variables" class="md-nav__link">
    Confounding variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interactions" class="md-nav__link">
    Interactions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#regression-diagnostics" class="md-nav__link">
    Regression Diagnostics
  </a>
  
    <nav class="md-nav" aria-label="Regression Diagnostics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#outliers-in-residuals" class="md-nav__link">
    Outliers in Residuals
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#influential-values" class="md-nav__link">
    Influential values
  </a>
  
    <nav class="md-nav" aria-label="Influential values">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hat-values" class="md-nav__link">
    Hat Values
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cooks-distance" class="md-nav__link">
    Cook's Distance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bubble-plot" class="md-nav__link">
    Bubble Plot
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="regression">Regression</h1>
<h2 id="parameters-confidence-intervals">Parameters Confidence Intervals</h2>
<p>Confidence intervals for regression coefficients:</p>
<ol>
<li>Draw $2n$ records from the original dataset (with replacement)</li>
<li>Fit regression model and record the coefficients</li>
<li>Repeat steps 1-2 $R$ times</li>
<li>For $(1-2p)$ confidence interval, get $p$ and $(1-p)$ level quantiles.</li>
</ol>
<h2 id="stepwise-regression">Stepwise Regression</h2>
<p><em>Stepwise regression</em> is the process of searching for the optimal set of predictor variables.</p>
<blockquote>
<p>💡 #story It’s common to use the principle of <em>Occam’s razor</em> when building a regression model: a simpler model (i.e. with fewer predictor variables) should be used in preference to a more complicated model, ceteris paribus.</p>
</blockquote>
<h3 id="vanilla-predictor-selection">Vanilla Predictor Selection</h3>
<p>Adding and dropping predictor variables based on adjusted R-squared or AIC metrics and statistical significance as you go.</p>
<h3 id="all-subset-regression">All Subset Regression</h3>
<p><em>All subset regression</em>: searching through each possible combination of predictor variables. Computationally expensive and most prone to overfitting.</p>
<h3 id="forward-selection">Forward Selection</h3>
<p><em>Forward selection</em>: start with no predictors at all (constant model) and add them one by one <em>greedily</em> (i.e. those having the largest contribution to the metric). The process stops when the contribution is no longer statistically significant.</p>
<h3 id="backward-selection">Backward Selection</h3>
<p><em>Backward regression</em> (<em>backward elimination</em>): start with all available predictor variables (i.e. the full model) and take away those which aren’t statistically significant until all the predictor variables are statistically significant.</p>
<h3 id="penalized-regression">Penalized Regression</h3>
<p>An alternate approach to stepwise regression is penalized regression: instead of eliminating predictors, it applies the $\ell_1$ penalty (<em>lasso regression</em>) or $\ell_2$ penalty (<em>ridge regression</em>) thus reducing coefficients of insignificant or highly correlated predictors.</p>
<h2 id="categorical-variables-in-regression">Categorical Variables in Regression</h2>
<p>Categorical variables are also called <em>factor variables</em>. Binary variables are also called <em>indicator variables</em>.</p>
<p>Factor variables are typically translated to <em>dummy variables</em> or <em>one-hot encoded</em> before fitting into the regression model. This is done via <code>pandas.get_dummies(series, drop_first=True)</code>.</p>
<blockquote>
<p>💡 One of the categories must be omitted to avoid multicollinearity, i.e. fitting a model with dependent variables. E.g. if factor variable $x$ can take ($p$) values $A$, $B$, or $C$, then if both $x_A$ and $x_B$ are false, $x_C$ must be true. Thus, only $x_A$ and $x_B$ (i.e. $p-1$, which is degrees of freedom) dummy variables should be kept.</p>
</blockquote>
<p>Factor variables with <em>too many</em> categories can be translated to numeric variables by mapping them to mean/median of the target (e.g. city id can be translated to median city house price) or residual from the target given by model ignoring this variable. Similarly, we can reduce the number of categories by grouping the obtained numeric values, producing new categories. This can be done via <code>pandas.qcut(series, q=4, labels=["s", "m", "l", "xl"])</code>.</p>
<p>Ordinal variables (or <em>ordered factor variables</em>) can be treated as numeric variables (or assigned to those according to order) in most cases. This helps to preserve the order.</p>
<h2 id="interpreting-the-regression-equation">Interpreting the Regression Equation</h2>
<p>In statistics, regression is mainly a tool for explanatory modeling, not for prediction. This can be of value for Data Science applications too.</p>
<h3 id="correlated-predictors">Correlated predictors</h3>
<p><em>Correlated predictors</em> can skew the coefficients to nonsense (i.e. total space, number of living rooms, and number of bathrooms)</p>
<h3 id="multicollinearity">Multicollinearity</h3>
<p><em>Multicollinearity</em> is the extreme case for correlated variables. It is usually the case when the model is fitted with the same predictor added multiple times by mistake, $p$ instead of $(p-1)$ dummy variables, or nearly perfectly correlated predictors.</p>
<h3 id="confounding-variables">Confounding variables</h3>
<p><em>Confounding</em> variables are mistakenly omitted variables of high significance. Ignoring them introduces randomness in coefficients and leads to incorrect conclusions.</p>
<h3 id="interactions">Interactions</h3>
<p><em>Interactions</em> are combinations (usually products) of predictor variables (or <em>main effects</em>). Adding meaningful interactions (e.g. house total space and price region) to the model can significantly improve scores and explainability.</p>
<blockquote>
<p>💡 Searching for the proper interaction of predictors can be challenging. Interactions are selected either based on prior experience or via stepwise regression approaches. Another way to account for interactions is switching to a non-linear model, e.g. decision trees, random forests, or XGBoost. Those search for optimal interactions automatically.</p>
</blockquote>
<h2 id="regression-diagnostics">Regression Diagnostics</h2>
<h3 id="outliers-in-residuals">Outliers in Residuals</h3>
<p>A general approach to detect outliers is based on boxplot or z-score (i.e. residual divided by the standard error of all residuals). Outliers of residuals can help spot anomalies in data (e.g. units mismatch, misspellings, column swap, etc.), including fraud.</p>
<h3 id="influential-values">Influential values</h3>
<p>Influential values have high <em>leverage</em> on regression, i.e. excluding these records would significantly change regression coefficients.</p>
<p>![[assets/img/Statistics/Regression/01.png|300]]</p>
<p>There are a few metrics to determine the influence of a single record:</p>
<h4 id="hat-values">Hat Values</h4>
<p>Given that $\hat{Y}=HY$, where $H$ is the hat matrix, diagonal values (<em>hat-values</em>) larger than $2(p+1)/n$ indicate high leverage records.</p>
<h4 id="cooks-distance">Cook's Distance</h4>
<p><em>Cook’s distance</em> larger than $4/(n-p-1)$ indicates high leverage records.</p>
<h4 id="bubble-plot">Bubble Plot</h4>
<p>A <em>bubble plot</em> is a scatter plot of hat-values versus residual z-scores with dot size equal to Cook’s distance.</p>
<p>![[assets/img/Statistics/Regression/02.png|300]]</p>
<h1 id="sourcecode-regression-codebubble-plot">sourcecode [[Regression Code#Bubble Plot]].</h1>
<h3 id="heteroskedasticity">Heteroskedasticity</h3>
<p><em>Heteroskedasticity</em> is a difference in residual variance across the range of predicted values, i.e. variance of the residual depends on the predicted value. It can be assessed visually from a scatter plot of predictions versus residuals with spline smoothing</p>
<p>![[assets/img/Statistics/Regression/03.png|400]]</p>
<h1 id="sourcecode-regression-codeheteroskedacticity-plot">sourcecode [[Regression Code#Heteroskedacticity Plot]].</h1>
<h3 id="residuals-distribution">Residuals Distribution</h3>
<p>The distribution of residuals, which is a subject of interest for statisticians exclusively, can actually tell much about the model quality. That is, normally distributed residuals indicate that the model is complete, whereas the opposite is a clear sign that the model is missing something.</p>
<h3 id="mean-squared-error-mse">Mean Squared Error (MSE)</h3>
<p>MSE is given by</p>
<p>$$
\text{MSE} = \frac{1}{m} \sum_{i=1}^m{
    \left(
        \boldsymbol{y}^{(i)}-\boldsymbol{\hat{y}}^{(i)}
    \right)^2
    }
$$</p>
<h3 id="root-mean-squared-error-rmse">Root Mean Squared Error (RMSE)</h3>
<p>RMSE is given by</p>
<p>$$
\text{RMSE} = \sqrt{
    \frac{1}{m} \sum_{i=1}^m{
        \left(
            \boldsymbol{y}^{(i)}-\boldsymbol{\hat{y}}^{(i)}
        \right)^2
    }
}
$$</p>
<h3 id="residual-standard-error-rse">Residual Standard Error (RSE)</h3>
<p>RSE is given by</p>
<p>$$
\text{RSE} = \sqrt{
    \frac{1}{m - n - 1} \sum_{i=1}^m{
        \left(
            \boldsymbol{y}^{(i)}-\boldsymbol{\hat{y}}^{(i)}
        \right)^2
    }
}
$$</p>
<p>the only difference is that the denominator is the degrees of freedom (i.e. number of records minus number of predictor variables minus one) instead of number of records.</p>
<h3 id="coefficient-of-determination-r-squared">Coefficient of determination (R-squared)</h3>
<p>R-squared is given by</p>
<p>$$ 
R^2 = 1 - \frac{\sum_{i=1}^m{
        \left(
            \boldsymbol{y}^{(i)}-\boldsymbol{\hat{y}}^{(i)}
        \right)^2
        }
    }
    {\sum_{i=1}^m{
        \left(
            \boldsymbol{y}^{(i)}-\boldsymbol{\overline{y}}^{(i)}
        \right)^2
    }
}
$$</p>
<p>The denominator is proportional to the target variance. Hence R-squared indicates the fraction of target variance accounted in the model.</p>
<h3 id="adjusted-r-squared">Adjusted R-squared</h3>
<p>Adjusted R-squared penalizes the model with too many predictor variables:</p>
<p>$$
R_{adj}^2 = 1 - \left( 1 - R^2 \right) \frac{m - 1}{m - n - 1}
$$</p>
<h3 id="akaikes-information-criterion-aic">Akaike’s information criterion (AIC)</h3>
<p>AIC takes into account model’s complexity</p>
<p>$$
\text{AIC} = 2n + m \log{(\text{MSE})}
$$</p>
<p>so that $n$ more predictor variables would be penalized by $2n$.</p>
<h3 id="t-statistic">T-Statistic</h3>
<p>The t-statistic is calculated for each model's parameter </p>
<p>$$
t_b=\frac{
        \boldsymbol{\theta}^{(i)}
    }
    {\text{SE}\left(\boldsymbol{\theta}^{(i)}\right)}
$$</p>
<p>where $\text{SE}$ is [[base/Statistics/Data and Sampling#Standard Error|Standard Error]] of parameter. It can be assessed similarly to [[base/Statistics/Regression#Parameters Confidence Intervals| parameters confidence intervals]] by [[Data and Sampling#Bootstrap|bootstrapping]] the data and refitting the model.</p>
<p>Since t-statistic is the mirror image of the p-value, the higher the value of t-statistic, the more statistically significant the predictor variable is.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "content.code.copy", "content.code.annotate", "content.code.select", "content.tooltips"], "search": "../../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.220ee61c.min.js"></script>
      
        
          <script src="../../../js/katex.js"></script>
        
      
        
          <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
        
      
        
          <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
        
      
    
  </body>
</html>